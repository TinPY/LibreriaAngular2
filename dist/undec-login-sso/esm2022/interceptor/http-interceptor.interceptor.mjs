import { catchError } from 'rxjs';
export const authInterceptorFunctional = (req, next) => {
    const authToken = localStorage.getItem('undec-token');
    if (!authToken) {
        const locationBase64 = window.btoa(unescape(encodeURIComponent(window.location.href)));
        const authUrl = "https://vm01undec.riu.edu.ar:8443/cancerbero/auth/login?state=" + locationBase64;
        window.location.assign(authUrl);
    }
    // Clone the request and add the authorization header
    const authReq = req.clone({
        setHeaders: {
            Authorization: `Bearer ${authToken}`
        }
    });
    // Pass the cloned request with the updated header to the next handler
    return next(authReq);
};
export const responseInterceptorFunctional = (req, next) => {
    return next(req)
        .pipe(catchError(error => {
        if (error.status === 403 || error.status === 401) {
            localStorage.clear();
            const authUrl = "https://vm01undec.riu.edu.ar:8443/cancerbero/auth/logout?logout_uri=" + window.location.origin + "/logout";
            window.location.assign(authUrl);
        }
        throw error;
    }));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC1pbnRlcmNlcHRvci5pbnRlcmNlcHRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3VuZGVjLWxvZ2luLXNzby9zcmMvaW50ZXJjZXB0b3IvaHR0cC1pbnRlcmNlcHRvci5pbnRlcmNlcHRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBRWhDLE1BQU0sQ0FBQyxNQUFNLHlCQUF5QixHQUFzQixDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRTtJQUN4RSxNQUFNLFNBQVMsR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBRXRELElBQUksQ0FBQyxTQUFTLEVBQUU7UUFDZCxNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUN0RixNQUFNLE9BQU8sR0FBRyxnRUFBZ0UsR0FBRyxjQUFjLENBQUE7UUFDakcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7S0FDakM7SUFFRCxxREFBcUQ7SUFDckQsTUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQztRQUN4QixVQUFVLEVBQUU7WUFDVixhQUFhLEVBQUUsVUFBVSxTQUFTLEVBQUU7U0FDckM7S0FDRixDQUFDLENBQUM7SUFFSCxzRUFBc0U7SUFDdEUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDdkIsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sNkJBQTZCLEdBQXNCLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO0lBQzVFLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQztTQUNYLElBQUksQ0FDRCxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDakIsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLEdBQUcsRUFBRTtZQUNoRCxZQUFZLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDckIsTUFBTSxPQUFPLEdBQUcsc0VBQXNFLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFBO1lBQzNILE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ2pDO1FBQ0QsTUFBTSxLQUFLLENBQUM7SUFDZCxDQUFDLENBQUMsQ0FDTCxDQUFBO0FBQ1AsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cEludGVyY2VwdG9yRm4gfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7Y2F0Y2hFcnJvcn0gZnJvbSAncnhqcyc7XHJcblxyXG5leHBvcnQgY29uc3QgYXV0aEludGVyY2VwdG9yRnVuY3Rpb25hbDogSHR0cEludGVyY2VwdG9yRm4gPSAocmVxLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgYXV0aFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VuZGVjLXRva2VuJyk7XHJcblxyXG4gIGlmICghYXV0aFRva2VuKSB7XHJcbiAgICBjb25zdCBsb2NhdGlvbkJhc2U2NCA9IHdpbmRvdy5idG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudCh3aW5kb3cubG9jYXRpb24uaHJlZikpKVxyXG4gICAgY29uc3QgYXV0aFVybCA9IFwiaHR0cHM6Ly92bTAxdW5kZWMucml1LmVkdS5hcjo4NDQzL2NhbmNlcmJlcm8vYXV0aC9sb2dpbj9zdGF0ZT1cIiArIGxvY2F0aW9uQmFzZTY0XHJcbiAgICB3aW5kb3cubG9jYXRpb24uYXNzaWduKGF1dGhVcmwpO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2xvbmUgdGhlIHJlcXVlc3QgYW5kIGFkZCB0aGUgYXV0aG9yaXphdGlvbiBoZWFkZXJcclxuICBjb25zdCBhdXRoUmVxID0gcmVxLmNsb25lKHtcclxuICAgIHNldEhlYWRlcnM6IHtcclxuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2F1dGhUb2tlbn1gXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFBhc3MgdGhlIGNsb25lZCByZXF1ZXN0IHdpdGggdGhlIHVwZGF0ZWQgaGVhZGVyIHRvIHRoZSBuZXh0IGhhbmRsZXJcclxuICByZXR1cm4gbmV4dChhdXRoUmVxKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNwb25zZUludGVyY2VwdG9yRnVuY3Rpb25hbDogSHR0cEludGVyY2VwdG9yRm4gPSAocmVxLCBuZXh0KSA9PiB7XHJcbiAgcmV0dXJuIG5leHQocmVxKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICAgIGNhdGNoRXJyb3IoZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDMgfHwgZXJyb3Iuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcclxuICAgICAgICAgICAgICBjb25zdCBhdXRoVXJsID0gXCJodHRwczovL3ZtMDF1bmRlYy5yaXUuZWR1LmFyOjg0NDMvY2FuY2VyYmVyby9hdXRoL2xvZ291dD9sb2dvdXRfdXJpPVwiICsgd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIFwiL2xvZ291dFwiXHJcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmFzc2lnbihhdXRoVXJsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgIH0pXHJcbiAgICAgIClcclxufVxyXG4iXX0=